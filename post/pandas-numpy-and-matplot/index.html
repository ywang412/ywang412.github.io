<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" >

<title>Pandas, Numpy and Matplot | Yu&#39;s Github</title>
<meta name="description" content="Java by day, Scala by night">

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
<link rel="shortcut icon" href="https://ywang412.github.io/favicon.ico?v=1572818856165">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
<link rel="stylesheet" href="https://ywang412.github.io/styles/main.css">


  

  
    <link rel="stylesheet" href="https://unpkg.com/disqusjs@1.1/dist/disqusjs.css" />
  


<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
<script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>

<link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css" />


<script async src="https://www.googletagmanager.com/gtag/js?id=UA-143424668-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-143424668-1');
</script>


  </head>
  <body>
    <div id="app" class="main">

      <div class="sidebar" :class="{ 'full-height': menuVisible }">
  <div class="top-container" data-aos="fade-right">
    <div class="top-header-container">
      <a class="site-title-container" href="https://ywang412.github.io">
        <img src="https://ywang412.github.io/images/avatar.png?v=1572818856165" class="site-logo">
        <h1 class="site-title">Yu&#39;s Github</h1>
      </a>
      <div class="menu-btn" @click="menuVisible = !menuVisible">
        <div class="line"></div>
      </div>
    </div>
    <div>
      
        
          <a href="/" class="site-nav">
            Home
          </a>
        
      
        
          <a href="/archives" class="site-nav">
            Archive
          </a>
        
      
        
          <a href="/tags" class="site-nav">
            Tag
          </a>
        
      
        
          <a href="/post/resume" class="site-nav">
            Resume
          </a>
        
      
    </div>
  </div>
  <div class="bottom-container" data-aos="flip-up" data-aos-offset="0">
    <div class="social-container">
      
        
          <a class="social-link" href="https://github.com/ywang412/" target="_blank">
            <i class="fab fa-github"></i>
          </a>
        
      
        
      
        
      
        
      
        
      
    </div>
    <div class="site-description">
      Java by day, Scala by night
    </div>
    <div class="site-footer">
      Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a> | <a class="rss" href="https://ywang412.github.io/atom.xml" target="_blank">RSS</a>
    </div>
  </div>
</div>


      <div class="main-container">
        <div class="content-container" data-aos="fade-up">
          <div class="post-detail">
            <h2 class="post-title">Pandas, Numpy and Matplot</h2>
            <div class="post-date">2018-09-18</div>
            
            <div class="post-content">
              <p><strong>Numpy</strong></p>
<p>To be able to operate on two np arrays, from the last axis to first axis the length should match or one of them should be one.</p>
<pre><code>arrA = np.array([[0., 0., 0.], [1., 1., 1.], [2., 2., 2.], [3., 3., 3.]])
arrB = np.array([1., 2., 3.])
arrA+arrB
</code></pre>
<pre><code>data = np.random.randn(3, 4)
[[ 0.81516464  0.54699707  0.25469129 -0.35725194]
 [-0.1594436   0.47096122 -0.51086806 -0.82336626]
 [-0.76274312  0.66010544  0.45585599  0.80401797]]
data[[True, False, False],1]
[ 0.54699707]
data[data &lt; 0]
[-0.35725194 -0.1594436  -0.51086806 -0.82336626 -0.76274312] 
</code></pre>
<p><strong>Pandas Series</strong></p>
<pre><code>s = pd.Series([-1.55666192,-0.75414753,0.47251231,-1.37775038,-1.64899442], index=['a', 'b', 'c', 'd', 'e'],dtype='int8' )
s = pd.Series(np.random.randn(5), index=['a', 'b', 'c', 'd', 'e'])
s = pd.Series({'a' : 0., 'b' : 1., 'c' : 2.},index=['b', 'c', 'd', 'a'])
b    1.0
c    2.0
d    NaN
a    0.0
s[['a','b','c']]
s[:2]
</code></pre>
<p><strong>Pandas dataframe</strong></p>
<pre><code>df = pd.DataFrame({'one': [1., 2., 3., 5], 'two': [1., 2., 3., 4.]})
   one  two
0  1.0  1.0
1  2.0  2.0
2  3.0  3.0
3  5.0  4.0
df = pd.DataFrame([[1., 2., 3., 5],[1., 2., 3., 4.]],index=['a', 'b'],columns=['one','two','three','four'])
   one  two  three  four
a  1.0  2.0    3.0   5.0
b  1.0  2.0    3.0   4.0

data = np.zeros((2,), dtype=[('A', 'i4'),('B', 'f4'),('C', 'a10')])
[(0,  0., '') (0,  0., '')]
data[:] = [(1,2.,'Hello'), (2,3.,&quot;World&quot;)] 
df = pd.DataFrame(data, index=['first', 'second'])
         A    B      C
first   1  2.0  Hello
second  2  3.0  World
data = {'one' : pd.Series([1., 2., 3.], index=['a', 'b', 'c']),
        'two' : pd.Series([1., 2., 3., 4.], index=['a', 'b', 'c', 'd'])}
   one  two
a  1.0  1.0
b  2.0  2.0
c  3.0  3.0
d  NaN  4.0
data2 = [{'a': 1, 'b': 2}, {'a': 5, 'b': 10, 'c': 20}]
df = pd.DataFrame(data2)
   a   b     c
0  1   2   NaN
1  5  10  20.0
</code></pre>
<pre><code># visit column
df['one']
df.one

#visit row
df[0:1]

# loc using label
df.loc['a']    # get a row
df.loc[:,['one','two'] ]    # get all rows for two columns
df.loc[['a',],['one','two']]

#iloc using index
df.iloc[0:2,0:1]
df.iloc[[0,2],[0,1]]
</code></pre>
<p><strong>CSV</strong></p>
<pre><code>df_csvload  =  pd.read_csv('C:\\Users\\Administrator\\Desktop\\table.csv',parse_dates=True,index_col=0,encoding='gb2312')
df_adddat = pd.DataFrame([{u'Open':1.1, u'High':1.2, u'Low':1.3, u'Close':1.4}, {u'Open':2.1, u'High':2.2, u'Low':2.3, u'Close':2.4}],index=[datetime.datetime.strptime(&quot;2016-06-25 00:00:00&quot;, &quot;%Y-%m-%d %H:%M:%S&quot;),datetime.datetime.strptime(&quot;2016-06-26 00:00:00&quot;, &quot;%Y-%m-%d %H:%M:%S&quot;)])
df_csvload = df_csvload.append(df_adddat)
df_csvload.to_csv('C:\\Users\\Administrator\\Desktop\\table-add.csv', columns=df_csvload.columns, index=True) 
</code></pre>
<pre><code>#3、Pandas工具快速入门：数据规整化处理

print(u&quot;**********************************1.1、数据信息查看*********************************************************&quot;)

#加载csv文件数据
df_csvload  = pd.read_csv('C:\\Users\\Administrator\\Desktop\\table.csv',parse_dates=True,index_col=0,encoding='gb2312')

print(df_csvload.head())#查看前几行   
print(df_csvload.tail())#查看后几行
print(df_csvload.columns)#查看列名
print(df_csvload.index)#查看索引
print(df_csvload.shape)#查看形状

print(df_csvload.describe())#查看各列数据描述性统计
print(df_csvload.info())#查看缺失及每列数据类型 事先去除数值
print(u&quot;**********************************1.2、缺失值处理*********************************************************&quot;)

print(df_csvload.isnull())#判断数据缺失值
print(df_csvload[df_csvload.isnull().T.any().T])#查看NAN值所在行
#只要有一个缺失值就删除该行
#df_csvload = df_csvload.dropna(axis=0,how='any')#NAN值删除 
#print(df_csvload)
df_csvload = df_csvload.dropna(axis=0,how='all')#NAN值删除 所有值都为缺失值时才删除该行
df_csvload.fillna(method='bfill',axis=0,inplace=True)#NAN值填充 列方向前值填充
print(df_csvload[df_csvload.isnull().values==True])#查看NAN值删除填充后值

print(u&quot;**********************************1.3、特殊值处理*********************************************************&quot;)

#df_csvload = df_csvload.applymap(lambda x:'%0.2f'%x)#保留2位小数
#print(df_csvload)
#print(df_csvload.info())
df_csvload = df_csvload.round(2)#保留2位小数
print(df_csvload)
print(df_csvload.info())
print(df_csvload[df_csvload.values==0])#查看df_csvload数据中所有0值的元素
df_csvload.loc[df_csvload.loc[:,'Low']==0,'Low'] = df_csvload.Low.median()#
print(df_csvload.loc['2018-01-15'])

print(u&quot;**********************************1.4、数据运算转化*********************************************************&quot;)

#数据运算
change = df_csvload.High - df_csvload.Low#最高价-最低价
df_csvload['pct_change'] = (change / df_csvload['Close'].shift(1)) #/昨收
print(df_csvload)
df_csvload['pct_change'].fillna(df_csvload['pct_change'].mean(),inplace=True) #序列第一个值Na
print(df_csvload)

print(u&quot;**********************************1.5、数据合并及连接*********************************************************&quot;)

#数据合并
dfv_csvload  = pd.read_csv('C:\\Users\\Administrator\\Desktop\\table-Volume.csv',parse_dates=True,index_col=0,encoding='gb2312')
df_concat =pd.concat([df_csvload, dfv_csvload],axis=1,keys=['Price','amount'])
print(df_concat)
</code></pre>
<p><strong>astype vs to_numeric</strong></p>
<pre><code># convert Series
my_series = pd.to_numeric(my_series)

# convert column &quot;a&quot; of a DataFrame
df[&quot;a&quot;] = pd.to_numeric(df[&quot;a&quot;])

# convert all columns of DataFrame
df = df.apply(pd.to_numeric) # convert all columns of DataFrame

# convert just columns &quot;a&quot; and &quot;b&quot;
df[[&quot;a&quot;, &quot;b&quot;]] = df[[&quot;a&quot;, &quot;b&quot;]].apply(pd.to_numeric)

# convert all DataFrame columns to the int64 dtype
df = df.astype(int)

# convert column &quot;a&quot; to int64 dtype and &quot;b&quot; to complex type
df = df.astype({&quot;a&quot;: int, &quot;b&quot;: complex})

# convert Series to float16 type
s = s.astype(np.float16)

# convert Series to Python strings
s = s.astype(str)

# convert Series to categorical type - see docs for more details
s = s.astype('category')
</code></pre>

            </div>
            
            
              <div class="next-post">
                <div class="next">下一篇</div>
                <a href="https://ywang412.github.io/post/python-3-quick-start-2-pep8">
                  <h3 class="post-title">
                    Python 3 quick start - 2 PEP8
                  </h3>
                </a>
              </div>
            

            
              

              
                <div id="disqus_thread" data-aos="fade-in"></div>
              
            

          </div>

        </div>
      </div>
    </div>

    <script src="https://unpkg.com/aos@next/dist/aos.js"></script>

<script type="application/javascript">

AOS.init();

hljs.initHighlightingOnLoad()

var app = new Vue({
  el: '#app',
  data: {
    menuVisible: false,
  },
})

</script>



  

  
    <script src="https://unpkg.com/disqusjs@1.1/dist/disqus.js"></script>
    <script>

    var options = {
      shortname: 'ywang412',
      apikey: 'gmr5wORrpUmczJ0fs6x1CjNX2WgIP2riU2sSqLrIo6Idh3GkyiY8WIpUwBaP70X5',
    }
    if ('') {
      options.api = ''
    }
    var dsqjs = new DisqusJS(options)

    </script>
  




  </body>
</html>
